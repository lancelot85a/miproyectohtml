<!DOCTYPE html>
<html lang="es">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Analizador VAK Mejorado con TextRazor</title>
	<style>
		/* Estilos CSS */
		:root {
			--visual-color: #0040ff;
			/* Azul */
			--auditory-color: #a10303;
			/* Rojo */
			--kinesthetic-color: #017564;
			/* Verde */
			--auditory-digital-color: #ff8c00;
			/* Naranja */
			--entity-color: #8e44ad;
			/* Morado */
			--neutral-color: #2c3e50;
			/* Color neutro */
			--bg-color: #f4f4f4;
			--text-color: #2c3e50;
			--header-bg: #ffffff;
			--card-bg: #fff;
			--tooltip-bg: rgba(0, 0, 0, 0.8);
			--tooltip-text: #fff;
			--button-hover: #8e44ad;
			--modal-bg: rgba(0, 0, 0, 0.5);
			--focus-outline: #3498db;
			--transition-speed: 0.3s;
			--title-font-size: 2.5em;
			--title-font-family: 'Verdana', sans-serif;
			--title-letter-spacing: 2px;
			--accordion-bg: #f9f9f9;
		}

		.dark-mode {
			--bg-color: #2c3e50;
			--text-color: #ecf0f1;
			--header-bg: #34495e;
			--card-bg: #2c3e50;
			--tooltip-bg: rgba(255, 255, 255, 0.9);
			--tooltip-text: #2c3e50;
			--button-hover: #5e2a7f;
			--accordion-bg: #34495e;
		}

		body {
			font-family: 'Verdana', sans-serif;
			line-height: 1.6;
			color: var(--text-color);
			margin: 0;
			padding: 0;
			background-color: var(--bg-color);
			transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
		}

		.container {
			max-width: 1400px;
			margin: 0 auto;
			background-color: var(--card-bg);
			border-radius: 10px;
			box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
			overflow: hidden;
			padding: 20px;
			transition: background-color var(--transition-speed) ease;
		}

		header {
			background-color: var(--header-bg);
			padding: 20px;
			text-align: center;
			border-radius: 10px 10px 0 0;
			transition: background-color var(--transition-speed) ease;
			position: relative;
			border: 2px solid #000;
		}

		h1 {
			color: var(--text-color);
			margin: 0;
			font-family: var(--title-font-family);
			font-size: var(--title-font-size);
			font-weight: bold;
			text-transform: uppercase;
			letter-spacing: var(--title-letter-spacing);
			text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
			transition: color var(--transition-speed) ease;
		}

		nav {
			display: flex;
			justify-content: center;
			background-color: var(--header-bg);
			padding: 10px;
			gap: 10px;
			flex-wrap: wrap;
			transition: background-color var(--transition-speed) ease;
		}

		nav button {
			padding: 10px 15px;
			border: none;
			border-radius: 5px;
			background-color: var(--neutral-color);
			color: white;
			cursor: pointer;
			transition: background-color var(--transition-speed) ease, transform 0.2s ease;
			min-width: 44px;
			min-height: 44px;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 16px;
		}

		nav button:hover {
			background-color: var(--button-hover);
			transform: scale(1.05);
		}

		nav button:focus {
			outline: 2px solid var(--focus-outline);
			outline-offset: 2px;
		}

		main {
			display: flex;
			flex-direction: column;
			padding: 20px;
			gap: 20px;
		}

		.text-input-section,
		.analysis-section {
			background-color: var(--card-bg);
			border-radius: 8px;
			padding: 20px;
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
			transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease, background-color var(--transition-speed) ease;
		}

		.text-input-section h2,
		.analysis-section h2 {
			font-size: 1.8em;
			margin-bottom: 15px;
			text-align: center;
			color: var(--text-color);
		}

		.textarea-container {
			width: 100%;
			margin-bottom: 20px;
		}

		.textarea-container textarea {
			width: 100%;
			height: 200px;
			padding: 10px;
			border-radius: 5px;
			border: 1px solid #ddd;
			font-size: 16px;
			resize: vertical;
			font-family: 'Verdana', sans-serif;
			transition: border-color var(--transition-speed) ease;
			background-color: var(--bg-color);
			color: var(--text-color);
		}

		.textarea-container textarea:hover,
		.textarea-container textarea:focus {
			border-color: var(--neutral-color);
			outline: none;
		}

		.analyze-button,
		.btn-export {
			display: block;
			width: 100%;
			padding: 10px;
			margin-top: 10px;
			border: none;
			border-radius: 5px;
			background-color: var(--neutral-color);
			color: white;
			font-size: 16px;
			cursor: pointer;
			transition: background-color var(--transition-speed) ease, transform 0.2s ease;
		}

		.analyze-button:hover,
		.btn-export:hover {
			background-color: var(--button-hover);
			transform: scale(1.02);
		}

		.analyze-button:focus,
		.btn-export:focus {
			outline: 2px solid var(--focus-outline);
			outline-offset: 2px;
		}

		.analysis-result {
			margin-top: 20px;
			padding: 15px;
			border-radius: 5px;
			background-color: var(--bg-color);
			white-space: pre-wrap;
			overflow-wrap: break-word;
		}

		.highlight {
			font-weight: bold;
			padding: 2px 4px;
			border-radius: 3px;
			position: relative;
			cursor: pointer;
		}

		.visual-word {
			background-color: var(--visual-color);
			color: white;
		}

		.auditory-word {
			background-color: var(--auditory-color);
			color: white;
		}

		.kinesthetic-word {
			background-color: var(--kinesthetic-color);
			color: white;
		}

		.auditory-digital-word {
			background-color: var(--auditory-digital-color);
			color: white;
		}

		.entity-word {
			background-color: var(--entity-color);
			color: white;
		}

		.stats-section {
			display: flex;
			justify-content: space-around;
			margin-top: 20px;
			flex-wrap: wrap;
			gap: 10px;
		}

		.stat-item {
			text-align: center;
			padding: 10px;
			background-color: var(--card-bg);
			border-radius: 5px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			flex: 1 1 150px;
		}

		.sequence-analysis,
		.entity-analysis {
			margin-top: 20px;
			padding: 15px;
			background-color: var(--bg-color);
			border-radius: 5px;
		}

		/* Modal Styles */
		.modal {
			display: none;
			position: fixed;
			z-index: 1000;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			overflow: auto;
			background-color: var(--modal-bg);
			transition: opacity var(--transition-speed) ease;
		}

		.modal-content {
			background-color: var(--card-bg);
			margin: 10% auto;
			padding: 20px;
			border: 1px solid #888;
			width: 90%;
			max-width: 500px;
			border-radius: 10px;
			position: relative;
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
			animation: fadeIn var(--transition-speed) ease;
			transition: background-color var(--transition-speed) ease;
			font-family: 'Verdana', sans-serif;
		}

		.close {
			color: #aaa;
			position: absolute;
			top: 10px;
			right: 20px;
			font-size: 28px;
			font-weight: bold;
			cursor: pointer;
			transition: color var(--transition-speed) ease;
		}

		.close:hover,
		.close:focus {
			color: black;
			text-decoration: none;
			cursor: pointer;
		}

		@keyframes fadeIn {
			from {
				opacity: 0;
				transform: translateY(-20px);
			}

			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		/* Tooltip Styles */
		.highlight[data-tooltip]::after {
			content: attr(data-tooltip);
			position: absolute;
			bottom: 125%;
			left: 50%;
			transform: translateX(-50%);
			background-color: var(--tooltip-bg);
			color: var(--tooltip-text);
			padding: 5px;
			border-radius: 6px;
			white-space: nowrap;
			opacity: 0;
			transition: opacity var(--transition-speed) ease;
			pointer-events: none;
			z-index: 1001;
		}

		.highlight[data-tooltip]::before {
			content: "";
			position: absolute;
			top: 100%;
			left: 50%;
			margin-left: -5px;
			border-width: 5px;
			border-style: solid;
			border-color: var(--tooltip-bg) transparent transparent transparent;
			opacity: 0;
			transition: opacity var(--transition-speed) ease;
			pointer-events: none;
			z-index: 1001;
		}

		.highlight[data-tooltip]:hover::after,
		.highlight[data-tooltip]:hover::before {
			opacity: 1;
		}

		/* Optimizaci√≥n Responsive */
		@media (max-width: 768px) {
			.container {
				padding: 10px;
			}

			h1 {
				font-size: 1.8em;
			}

			.text-input-section textarea {
				height: 150px;
			}

			.stats-section {
				flex-direction: column;
				align-items: center;
			}

			.stat-item {
				width: 100%;
				margin-bottom: 10px;
			}

			.analyze-button,
			.btn-export {
				width: 100%;
			}

			.modal-content {
				margin: 20% auto;
			}
		}

		/* Sem√°ntica y Accesibilidad */
		.sr-only {
			position: absolute;
			width: 1px;
			height: 1px;
			padding: 0;
			margin: -1px;
			overflow: hidden;
			clip: rect(0, 0, 0, 0);
			white-space: nowrap;
			border: 0;
		}
	</style>
</head>

<body>
	<div class="container">
		<header>
			<h1>Analizador VAK Mejorado con TextRazor</h1>
		</header>
		<nav>
			<button id="toggle-theme" aria-label="Alternar modo oscuro">üåô Modo Oscuro</button>
			<button id="show-info" aria-label="Mostrar informaci√≥n">‚ÑπÔ∏è Informaci√≥n</button>
			<button id="show-stats" aria-label="Mostrar estad√≠sticas">üìä Estad√≠sticas</button>
		</nav>
		<main>
			<section class="text-input-section">
				<h2>Ingrese su texto para analizar</h2>
				<div class="textarea-container">
					<label for="text-input" class="sr-only">Ingresa tu texto aqu√≠</label>
					<textarea id="text-input" placeholder="Escriba o pegue su texto aqu√≠..." aria-label="√Årea de texto para ingresar el discurso"></textarea>
				</div>
				<button id="analyze-btn" class="analyze-button" aria-label="Analizar texto">Analizar Texto</button>
			</section>
			<section class="analysis-section">
				<h2>Resultado del An√°lisis</h2>
				<div id="analysis-result" class="analysis-result">
					El texto analizado aparecer√° aqu√≠...
				</div>
				<div class="stats-section">
					<div class="stat-item">
						<h3>Visual</h3>
						<p id="visual-count">0</p>
					</div>
					<div class="stat-item">
						<h3>Auditivo</h3>
						<p id="auditory-count">0</p>
					</div>
					<div class="stat-item">
						<h3>Kinest√©sico</h3>
						<p id="kinesthetic-count">0</p>
					</div>
					<div class="stat-item">
						<h3>Auditivo Digital</h3>
						<p id="auditory-digital-count">0</p>
					</div>
				</div>
				<div class="sequence-analysis">
					<h3>An√°lisis de Secuencia</h3>
					<p id="sequence-result">La secuencia predominante aparecer√° aqu√≠...</p>
				</div>
				<div class="entity-analysis">
					<h3>Entidades Nombradas</h3>
					<p id="entity-result">Las entidades identificadas aparecer√°n aqu√≠...</p>
				</div>
			</section>
			<button class="btn-export" id="export-results" aria-label="Exportar resultados">Exportar Resultados</button>
		</main>
	</div>

	<!-- Modal de Estad√≠sticas -->
	<div id="stats-modal" class="modal" aria-hidden="true" role="dialog" aria-labelledby="stats-title"
		aria-modal="true">
		<div class="modal-content">
			<span class="close" aria-label="Cerrar">&times;</span>
			<div class="stats-content" id="stats-content">
				<h2 id="stats-title">üìä Estad√≠sticas de Usuario</h2>
				<p>Textos Analizados: <span id="texts-analyzed">0</span></p>
				<p>Palabras Visuales: <span id="visual-count-modal">0</span></p>
				<p>Palabras Auditivas: <span id="auditory-count-modal">0</span></p>
				<p>Palabras Kinest√©sicas: <span id="kinesthetic-count-modal">0</span></p>
				<p>Palabras Auditivo Digital: <span id="auditory-digital-count-modal">0</span></p>
			</div>
		</div>
	</div>

	<!-- Modal Informativo -->
	<div id="info-modal" class="modal" aria-hidden="true" role="dialog" aria-labelledby="info-title" aria-modal="true">
		<div class="modal-content">
			<span class="close" aria-label="Cerrar">&times;</span>
			<h2 id="info-title">‚ÑπÔ∏è Informaci√≥n sobre el Analizador VAK Mejorado</h2>
			<p>El Analizador VAK es una herramienta dise√±ada para identificar elementos sensoriales en textos, bas√°ndose
				en el modelo de Programaci√≥n Neuroling√º√≠stica (PNL) que clasifica la percepci√≥n en cuatro sistemas
				principales: Visual, Auditivo, Kinest√©sico y Auditivo Digital.</p>
			<h3>C√≥mo funciona:</h3>
			<ul>
				<li><strong>Visual:</strong> Identifica palabras relacionadas con la vista y las im√°genes mentales.</li>
				<li><strong>Auditivo:</strong> Detecta t√©rminos asociados con el sonido y la escucha.</li>
				<li><strong>Kinest√©sico:</strong> Reconoce palabras vinculadas a sensaciones y emociones.</li>
				<li><strong>Auditivo Digital:</strong> Detecta t√©rminos relacionados con el pensamiento l√≥gico y
					anal√≠tico.</li>
			</ul>
			<p>Adem√°s, utilizando la API de TextRazor, el analizador identifica entidades nombradas y relaciones
				sem√°nticas
				para enriquecer el an√°lisis y proporcionar una comprensi√≥n m√°s profunda del texto.</p>
		</div>
	</div>

	<script>
		// Funci√≥n para escapar caracteres especiales en expresiones regulares
        function escapeRegExp(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        // Listas de palabras VAK usando ra√≠ces y patrones
        const visualPatterns = [
            /\b(visual\w*)\b/gi,
            /\b(clar\w*)\b/gi,
            /\b(vid\w*)\b/gi,
            /\b(mir\w*)\b/gi,
            /\b(observ\w*)\b/gi,
            /\b(enfoc\w*)\b/gi,
            /\b(perspect\w*)\b/gi,
            /\b(imagen\w*)\b/gi,
            /\b(color\w*)\b/gi,
            /\b(aparienc\w*)\b/gi,
            /\b(sombr\w*)\b/gi,
            /\b(visualizar\w*)\b/gi,
            /\b(ilumin\w*)\b/gi,
            /\b(visi√≥n)\b/gi,
            /\b(ver)\b/gi,
            /\b(visto)\b/gi,
            /\b(veo)\b/gi
        ];

        const auditoryPatterns = [
            /\b(audit\w*)\b/gi,
            /\b(sonid\w*)\b/gi,
            /\b(escuch\w*)\b/gi,
            /\b(o[i|√≠|y]r\w*)\b/gi,
            /\b(habl\w*)\b/gi,
            /\b(sonar\w*)\b/gi,
            /\b(reson\w*)\b/gi,
            /\b(ruido\w*)\b/gi,
            /\b(silenci\w*)\b/gi,
            /\b(susurr\w*)\b/gi,
            /\b(melod\w*)\b/gi,
            /\b(cantar\w*)\b/gi,
            /\b(grit\w*)\b/gi,
            /\b(decir\w*)\b/gi,
            /\b(escucho)\b/gi
        ];

        const kinestheticPatterns = [
            /\b(sent\w*)\b/gi,
            /\b(tocar\w*)\b/gi,
            /\b(sensac\w*)\b/gi,
            /\b(mov\w*)\b/gi,
            /\b(camin\w*)\b/gi,
            /\b(correr\w*)\b/gi,
            /\b(calor\w*)\b/gi,
            /\b(fr[i|√≠]o\w*)\b/gi,
            /\b(presi[√≥|o]n\w*)\b/gi,
            /\b(fuerz\w*)\b/gi,
            /\b(sostener\w*)\b/gi,
            /\b(tens[√≥|o]n\w*)\b/gi,
            /\b(agarra\w*)\b/gi,
            /\b(golpe\w*)\b/gi,
            /\b(palpit\w*)\b/gi,
            /\b(siento)\b/gi
        ];

        const auditoryDigitalPatterns = [
            /\b(pens\w*)\b/gi,
            /\b(concept\w*)\b/gi,
            /\b(entend\w*)\b/gi,
            /\b(comprend\w*)\b/gi,
            /\b(conoc\w*)\b/gi,
            /\b(l√≥gic\w*)\b/gi,
            /\b(analiz\w*)\b/gi,
            /\b(proces\w*)\b/gi,
            /\b(sistem\w*)\b/gi,
            /\b(calcul\w*)\b/gi,
            /\b(estudi\w*)\b/gi,
            /\b(cuestion\w*)\b/gi,
            /\b(inform\w*)\b/gi,
            /\b(decid\w*)\b/gi,
            /\b(plane\w*)\b/gi,
            /\b(razon\w*)\b/gi,
            /\b(ideas?)\b/gi,
            /\b(pensamiento)\b/gi
        ];

        // Variables de Usuario
        let userStats = {
            textsAnalyzed: 0,
            visualCount: 0,
            auditoryCount: 0,
            kinestheticCount: 0,
            auditoryDigitalCount: 0
        };

        function highlightText(text) {
            let visualCount = 0;
            let auditoryCount = 0;
            let kinestheticCount = 0;
            let auditoryDigitalCount = 0;

            // Tokenizar el texto para evitar reemplazos dentro de etiquetas HTML
            const tokens = text.split(/(\s+|\n|<br>)/);

            // Orden de categor√≠as para evitar superposiciones
            const categories = [
                { patterns: auditoryDigitalPatterns, class: 'auditory-digital-word', type: 'Auditivo Digital' },
                { patterns: visualPatterns, class: 'visual-word', type: 'Visual' },
                { patterns: auditoryPatterns, class: 'auditory-word', type: 'Auditivo' },
                { patterns: kinestheticPatterns, class: 'kinesthetic-word', type: 'Kinest√©sico' }
            ];

            const highlightedTokens = tokens.map(token => {
                if (/^\s+$/.test(token) || token === '\n' || token === '<br>') {
                    return token;
                }

                let matched = false;

                for (const category of categories) {
                    for (const pattern of category.patterns) {
                        if (pattern.test(token)) {
                            matched = true;

                            // Incrementar el contador correspondiente
                            if (category.type === 'Visual') visualCount++;
                            if (category.type === 'Auditivo') auditoryCount++;
                            if (category.type === 'Kinest√©sico') kinestheticCount++;
                            if (category.type === 'Auditivo Digital') auditoryDigitalCount++;

                            return `<span class="highlight ${category.class}" data-tooltip="${category.type}: ${token}">${token}</span>`;
                        }
                    }
                    if (matched) break;
                }

                return token;
            });

            const highlighted = highlightedTokens.join('');

            return { highlighted, visualCount, auditoryCount, kinestheticCount, auditoryDigitalCount };
        }

        function updateStats() {
            document.getElementById('texts-analyzed').textContent = userStats.textsAnalyzed;
            document.getElementById('visual-count').textContent = userStats.visualCount;
            document.getElementById('auditory-count').textContent = userStats.auditoryCount;
            document.getElementById('kinesthetic-count').textContent = userStats.kinestheticCount;
            document.getElementById('auditory-digital-count').textContent = userStats.auditoryDigitalCount;

            // Actualizar tambi√©n en el modal
            document.getElementById('visual-count-modal').textContent = userStats.visualCount;
            document.getElementById('auditory-count-modal').textContent = userStats.auditoryCount;
            document.getElementById('kinesthetic-count-modal').textContent = userStats.kinestheticCount;
            document.getElementById('auditory-digital-count-modal').textContent = userStats.auditoryDigitalCount;
        }

        function exportResults() {
            const analyzedText = document.getElementById('analysis-result').innerText;
            const sequence = document.getElementById('sequence-result').textContent;
            const entities = document.getElementById('entity-result').textContent;
            const content = `Texto Analizado:\n${analyzedText}\n\n${sequence}\n\n${entities}`;
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'resultado_vak.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const toggleButton = document.getElementById('toggle-theme');
            if (document.body.classList.contains('dark-mode')) {
                toggleButton.innerText = '‚òÄÔ∏è Modo Claro';
                toggleButton.setAttribute('aria-label', 'Alternar modo claro');
            } else {
                toggleButton.innerText = 'üåô Modo Oscuro';
                toggleButton.setAttribute('aria-label', 'Alternar modo oscuro');
            }
        }

        // Funci√≥n para mostrar estad√≠sticas
        function showStats() {
            showModal('stats-modal');
        }

        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.display = 'block';
            modal.setAttribute('aria-hidden', 'false');
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.display = 'none';
            modal.setAttribute('aria-hidden', 'true');
        }

        // Event Listeners
        document.getElementById('analyze-btn').addEventListener('click', analyzeText);
        document.getElementById('export-results').addEventListener('click', exportResults);
        document.getElementById('toggle-theme').addEventListener('click', toggleDarkMode);
        document.getElementById('show-info').addEventListener('click', function () {
            showModal('info-modal');
        });
        document.getElementById('show-stats').addEventListener('click', showStats);

        // Cerrar modales al hacer clic en el bot√≥n de cerrar
        document.querySelectorAll('.close').forEach(closeBtn => {
            closeBtn.addEventListener('click', function () {
                const modal = this.closest('.modal');
                closeModal(modal.id);
            });
        });

        // Cerrar modales si el usuario hace clic fuera de ellos
        window.addEventListener('click', function (event) {
            document.querySelectorAll('.modal').forEach(modal => {
                if (event.target === modal) {
                    closeModal(modal.id);
                }
            });
        });

        // Detectar preferencia de color del sistema y ajustar autom√°ticamente
        function detectColorScheme() {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.classList.add('dark-mode');
                document.getElementById('toggle-theme').innerText = '‚òÄÔ∏è Modo Claro';
                document.getElementById('toggle-theme').setAttribute('aria-label', 'Alternar modo claro');
            }
        }

        window.addEventListener('load', () => {
            detectColorScheme();
        });

        // Integraci√≥n con la API de TextRazor
        async function analyzeText() {
            const textInput = document.getElementById('text-input').value;
            if (!textInput.trim()) {
                alert("Por favor, ingresa un texto para analizar.");
                return;
            }

            // Analizar el texto localmente
            const analysis = highlightText(textInput);
            document.getElementById('analysis-result').innerHTML = analysis.highlighted;

            // Actualizar estad√≠sticas
            userStats.textsAnalyzed++;
            userStats.visualCount += analysis.visualCount;
            userStats.auditoryCount += analysis.auditoryCount;
            userStats.kinestheticCount += analysis.kinestheticCount;
            userStats.auditoryDigitalCount += analysis.auditoryDigitalCount;
            updateStats();

            // Mostrar secuencia
            const sequence = getSequence(textInput);
            document.getElementById('sequence-result').textContent = `Secuencia VAK: ${sequence.join(' ‚ûî ')}`;

            // An√°lisis adicional con TextRazor
            await analyzeWithTextRazor(textInput);
        }

        function getSequence(text) {
            const words = text.toLowerCase().split(/\s+/);
            const sequence = [];
            const added = new Set();

            const categories = [
                { patterns: auditoryDigitalPatterns, symbol: 'AD' },
                { patterns: visualPatterns, symbol: 'V' },
                { patterns: auditoryPatterns, symbol: 'A' },
                { patterns: kinestheticPatterns, symbol: 'K' }
            ];

            words.forEach(word => {
                // Eliminar puntuaci√≥n
                const cleanWord = word.replace(/[.,!?;:()]+$/g, '').toLowerCase();
                for (const category of categories) {
                    for (const pattern of category.patterns) {
                        if (pattern.test(cleanWord) && !added.has(category.symbol)) {
                            sequence.push(category.symbol);
                            added.add(category.symbol);
                            break;
                        }
                    }
                }
            });

            return sequence;
        }

        async function analyzeWithTextRazor(text) {
            const apiKey = prompt("Por favor, ingresa tu clave API de TextRazor:");
            if (!apiKey) {
                alert("Se requiere una clave API para continuar con el an√°lisis.");
                return;
            }

            try {
                const response = await fetch('https://api.textrazor.com/', {
                    method: 'POST',
                    headers: {
                        'x-textrazor-key': apiKey,
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: `text=${encodeURIComponent(text)}&extractors=entities,topics,relations&language=spa`
                });

                if (!response.ok) {
                    throw new Error('Error en la respuesta de TextRazor');
                }

                const data = await response.json();

                // Procesar y mostrar los resultados adicionales
                processTextRazorData(data);

            } catch (error) {
                console.error('Error al comunicarse con TextRazor:', error);
                alert('Ocurri√≥ un error al analizar el texto con TextRazor.');
            }
        }

        function processTextRazorData(data) {
            if (!data.response) {
                alert('No se obtuvieron resultados de TextRazor.');
                return;
            }

            // Mostrar entidades nombradas
            const entities = data.response.entities || [];
            const uniqueEntities = new Set();
            entities.forEach(entity => {
                uniqueEntities.add(entity.matchedText);
            });

            const entityResult = Array.from(uniqueEntities).join(', ');
            document.getElementById('entity-result').textContent = `Entidades: ${entityResult}`;

            // Resaltar entidades en el texto
            let analysisResultHTML = document.getElementById('analysis-result').innerHTML;

            uniqueEntities.forEach(entity => {
                const entityRegex = new RegExp(`\\b(${escapeRegExp(entity)})\\b`, 'gi');
                analysisResultHTML = analysisResultHTML.replace(entityRegex, (match) => {
                    return `<span class="highlight entity-word" data-tooltip="Entidad: ${match}">${match}</span>`;
                });
            });

            document.getElementById('analysis-result').innerHTML = analysisResultHTML;

            // Puedes procesar y mostrar temas o relaciones sem√°nticas si lo deseas
            // Por ejemplo, mostrar los temas principales
            const topics = data.response.topics || [];
            const topTopics = topics.slice(0, 5).map(topic => topic.label).join(', ');
            if (topTopics) {
                const topicElement = document.createElement('p');
                topicElement.textContent = `Temas Principales: ${topTopics}`;
                document.querySelector('.entity-analysis').appendChild(topicElement);
            }
        }

	</script>
</body>

</html>